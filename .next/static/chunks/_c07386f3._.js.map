{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://E%3A/PingProspect/pingprospect-nextapp/components/Auth/Authfirebase.ts"],"sourcesContent":["import { initializeApp } from \"firebase/app\";\r\nimport {\r\n  getAuth,\r\n  GoogleAuthProvider,\r\n  signInWithPopup,\r\n  signOut,\r\n} from \"firebase/auth\";\r\nimport { getFirestore, doc, setDoc , getDoc } from \"firebase/firestore\";\r\n\r\n\r\ninterface UserData {\r\n  sub: string; // Firebase UID used as the document ID\r\n  fullName: string;\r\n  email: string;\r\n  email_verified: boolean;\r\n  picture: string;\r\n  subscription_status: string;\r\n  user_created_at: Date;\r\n}\r\n\r\nclass FirebaseService {\r\n  app: any;\r\n  auth: any;\r\n  googleProvider = new GoogleAuthProvider();\r\n  db: any;\r\n  \r\n  firebaseConfig = {\r\n    apiKey: process.env.API_KEY,\r\n    authDomain: process.env.AUTH_DOMAIN,\r\n    databaseURL: process.env.DATABASE_URL,\r\n    projectId: process.env.PROJECT_ID,\r\n    appId: process.env.APP_ID,\r\n    measurementId: process.env.MEASUREMENT_ID,\r\n  };\r\n\r\n  constructor() {\r\n    this.app = initializeApp(this.firebaseConfig);\r\n    this.auth = getAuth(this.app);\r\n    this.db = getFirestore(this.app);\r\n    \r\n  }\r\n\r\n  // create document\r\n  async createUserDocument(userData: UserData) {\r\n    try {\r\n      \r\n      // Create a reference to the document in the \"users\" collection with the ID as userData.sub\r\n      const userRef = doc(this.db, \"users\", userData.sub);\r\n      // Check if the document already exists\r\n      const userDoc = await getDoc(userRef);\r\n      if (!userDoc.exists()) {\r\n        // Document doesnâ€™t exist, so create it\r\n        await setDoc(userRef, userData);\r\n        // Add a 1-second delay to allow Firestore to finish any pending tasks\r\n        await new Promise((resolve) => setTimeout(resolve, 500));\r\n        console.log(\"User document created with ID:\", userData.sub);\r\n      } else {\r\n        // Document already exists, so skip creating/overwriting\r\n        console.log(\"User document already exists for ID:\", userData.sub);\r\n      }\r\n      console.log(\"User document created with ID:\", userData.sub);\r\n    } catch (error) {\r\n      console.error(\"Error creating user document:\", error);\r\n      throw error; // Re-throw the error for handling by the caller\r\n    }\r\n  }\r\n\r\n  async createUserAccount() {\r\n    try {\r\n      const result = await signInWithPopup(this.auth, this.googleProvider);\r\n      const credential = GoogleAuthProvider.credentialFromResult(result);\r\n      const idToken = credential?.idToken;\r\n      const user = result.user;\r\n      const userData = {\r\n        sub: user.uid, // Firebase UID used as the document ID\r\n        fullName: user.displayName || \"\",\r\n        email: user.email || \"\",\r\n        email_verified: user.emailVerified,\r\n        picture: user.photoURL || \"\",\r\n        subscription_status: \"Free\",\r\n        user_created_at: new Date(),\r\n        \r\n      };\r\n      await this.createUserDocument(userData);\r\n      \r\n      if (window !== undefined) {\r\n        window.location.href = \"pingprospect://\" + idToken;\r\n      }\r\n      return idToken;\r\n    } catch (error) {\r\n      console.error(\"Sign-in error:\", error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async SiginOut() {\r\n    try {\r\n      await signOut(this.auth);\r\n    } catch (error) {\r\n      throw error;\r\n    }\r\n  }\r\n}\r\n\r\nexport const Service = new FirebaseService();\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 107, "column": 0}, "map": {"version":3,"sources":["file://E%3A/PingProspect/pingprospect-nextapp/app/auth/SignIn.tsx"],"sourcesContent":["\"use client\"\r\nimport { useEffect, useState } from \"react\";\r\nimport { Service } from \"../../components/Auth/Authfirebase\";\r\nimport { onAuthStateChanged } from \"firebase/auth\";\r\n\r\nfunction SignIn() {\r\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\r\n\r\n  useEffect(() => {\r\n    console.log(\"Measurement ID : \" ,process.env.MEASUREMENT_ID);\r\n    const unsubscribe = onAuthStateChanged(Service.auth, (user) => {\r\n      if (user) {\r\n        setIsLoggedIn(true);\r\n        console.log(\"User UID:\", user.uid);\r\n        \r\n      } else {\r\n        setIsLoggedIn(false);\r\n        console.log(\"User is not loggedIn\");\r\n      }\r\n    });\r\n    // Cleanup subscription on unmount\r\n    return () => unsubscribe();\r\n  }, []);\r\n\r\n  const handleLogin = () => {\r\n    Service.createUserAccount();\r\n  };\r\n  const handleLogout = () => {\r\n    Service.SiginOut();\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex min-h-screen w-full items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-50 p-4\">\r\n      <div className=\"w-full max-w-md rounded-2xl bg-white p-8 shadow-xl\">\r\n        <h2 className=\"mb-8 text-center text-3xl font-bold text-gray-800\">\r\n        Welcome to PingProspect\r\n        </h2>\r\n\r\n        {isLoggedIn ? (\r\n          <button\r\n          onClick={handleLogout}\r\n          className=\"w-full rounded-lg bg-[#357AFF] px-4 py-3 text-base font-medium text-white transition-colors hover:bg-[#2E69DE] focus:outline-none focus:ring-2 focus:ring-[#357AFF] focus:ring-offset-2 disabled:opacity-50\"\r\n        > \r\n           <span className=\"text-base\">Signout</span>\r\n        </button>\r\n        ) : (\r\n          <button\r\n            onClick={handleLogin}\r\n            className=\"w-full rounded-lg bg-[#357AFF] px-4 py-3 text-base font-medium text-white transition-colors hover:bg-[#2E69DE] focus:outline-none focus:ring-2 focus:ring-[#357AFF] focus:ring-offset-2 disabled:opacity-50\"\r\n          > \r\n             <span> SignIn with Google</span>\r\n          </button>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default SignIn;\r\n"],"names":[],"mappings":";;;AASqC;;AARrC;AACA;AACA;AAAA;;;AAHA;;;;AAKA,SAAS;;IACP,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAE7C,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;4BAAE;YACR,QAAQ,GAAG,CAAC,qBAAqB,gKAAA,CAAA,UAAO,CAAC,GAAG,CAAC,cAAc;YAC3D,MAAM,cAAc,CAAA,GAAA,wNAAA,CAAA,qBAAkB,AAAD,EAAE,qIAAA,CAAA,UAAO,CAAC,IAAI;gDAAE,CAAC;oBACpD,IAAI,MAAM;wBACR,cAAc;wBACd,QAAQ,GAAG,CAAC,aAAa,KAAK,GAAG;oBAEnC,OAAO;wBACL,cAAc;wBACd,QAAQ,GAAG,CAAC;oBACd;gBACF;;YACA,kCAAkC;YAClC;oCAAO,IAAM;;QACf;2BAAG,EAAE;IAEL,MAAM,cAAc;QAClB,qIAAA,CAAA,UAAO,CAAC,iBAAiB;IAC3B;IACA,MAAM,eAAe;QACnB,qIAAA,CAAA,UAAO,CAAC,QAAQ;IAClB;IAEA,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAG,WAAU;8BAAoD;;;;;;gBAIjE,2BACC,6LAAC;oBACD,SAAS;oBACT,WAAU;8BAET,cAAA,6LAAC;wBAAK,WAAU;kCAAY;;;;;;;;;;yCAG7B,6LAAC;oBACC,SAAS;oBACT,WAAU;8BAET,cAAA,6LAAC;kCAAK;;;;;;;;;;;;;;;;;;;;;;AAMnB;GAnDS;KAAA;uCAqDM","debugId":null}}]
}